# H2K Sanitizer (`scrubbing-h2k-files.py`)

A command-line tool to **sanitize EnerGuide/HOT2000 `.H2K` XML files** by removing personally identifiable information (PII) and standardizing certain fields for safe sharing.

## Highlights

- **Path-agnostic**: no hard-coded directories — pass everything via CLI.
- **In-place or copy**: edit the originals (`--in-place`) or write sanitized copies to `--dest` while preserving filenames and folder structure.
- **Identification handling**: set `<Identification>` to the destination **filename stem** (default), the full **filename**, or leave it unchanged.
- **Aggressive PII scrubbing**:
  - `<ProgramInformation><File>`: clears `TaxNumber`, `Company`, `CompanyTelephone`, `EnteredBy`, and more.
  - `<Client>`: clears `First`, `Last`, `Telephone`, and mailing/street addresses (ensures `UnitNumber` exists).
  - **Global scrub** (anywhere in the XML): clears `UserTelephone`, `UserExtension`, `CompanyTelephone`, `EAphone`, `SOphone`, and `HomeownerAuthorizationId`.
  - `<Results><Tsv>`: wipes **all** values and text under **every** `<Tsv>` (or delete `<Tsv>` entirely with `--drop-tsv`).
  - **ERS Results**: empties `value` for tags matching `HOC[a-zA-Z]` under `<Results>`.
- **Weather preserved**: only read from `<Weather>` to set province info — no modifications are made there.
- **Builder privacy**: replaces `<BuilderName>` with a **province-based anonymized code**.
- **Summary output**: CSV mapping of `<Identification>`, filename, and builder codes.

---

## Requirements

- **Python 3.10+**
- The script operates on **XML-based `.H2K`** files generated by HOT2000/EnerGuide tools.

---

## Installation

No package install required. Place `scrubbing-h2k-files.py` anywhere on your machine.

---

## Usage

Run from Command Prompt or PowerShell.

### Basic: copy sanitized files to a destination folder

```bash
python scrubbing-h2k-files.py \
  --origin "D:\\input_h2k" \
  --dest   "D:\\output_sanitized"